(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[908],{681:function(e,a,t){Promise.resolve().then(t.bind(t,49))},835:function(e,a,t){"use strict";t.d(a,{rl:function(){return l}});let l="http://localhost:3031"},49:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return u}});var l=t(7437),s=t(2265),n=t(3671),r=t(8472),d=t(835),i=t(245),c=t.n(i);t(4575);var o=t(6463);function u(){let e=(0,o.useRouter)(),[a,t]=(0,s.useState)(null),[i,u]=(0,s.useState)([]),[h,x]=(0,s.useState)(!0),[j,p]=(0,s.useState)(null),[b,g]=(0,s.useState)([]),[m,v]=(0,s.useState)(1),[_,S]=(0,s.useState)(0),[y,k]=(0,s.useState)(0),[f,N]=(0,s.useState)(""),[C,w]=(0,s.useState)(null),[T,E]=(0,s.useState)(null),[F,O]=(0,s.useState)(0),[P,D]=(0,s.useState)(0),[q,Z]=(0,s.useState)(""),[B,A]=(0,s.useState)(""),[H,R]=(0,s.useState)(""),[K,L]=(0,s.useState)("");(0,s.useEffect)(()=>{(async()=>{try{x(!0);let e=(await r.Z.get(d.rl+"/api/product/find/0")).data.data.map(e=>({id_barang:e.id,value:e.kode,label:e.name,harga:parseFloat(e.harga)}));u(e)}catch(e){p(e.message)}finally{x(!1)}})()},[]);let M=()=>{t(null),v(1),S(0),k(0),w(null),E(null)},Q=e=>{g(b.filter((a,t)=>t!==e))},G=e=>{let a=b[e];w(e),t({value:a.value,label:a.label,harga:a.price,id_barang:a.id_barang}),v(a.qty),S(a.price),k(a.discount_percent)},I=b.reduce((e,a)=>e+a.total,0),J=I+P-F,Y=async a=>{a.preventDefault();try{let a=await r.Z.post("".concat(d.rl,"/api/cust/save"),{kode:B,name:H,telp:K,email:"empty"}),t=await r.Z.post("".concat(d.rl,"/api/sales/save"),{kode:q,tgl:T,cust_id:a.data.data.id,subtotal:I,diskon:F,ongkir:P,total_bayar:J});alert(t.data.content.data),(await r.Z.post("".concat(d.rl,"/api/sales_detail/save"),{sales_id:q,item:JSON.stringify(b)})).status=200,e.push("/dashboard")}catch(e){console.error("Error submitting data:",e.message)}};return(0,l.jsxs)("div",{children:[(0,l.jsx)("table",{className:"min-w-full border border-gray-300",children:(0,l.jsxs)("tbody",{children:[(0,l.jsxs)("tr",{children:[(0,l.jsxs)("td",{colSpan:2,className:"border border-gray-300 p-2",children:[(0,l.jsx)("div",{children:(0,l.jsx)("h6",{children:"Transaksi"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{children:"No"}),(0,l.jsx)("input",{id:"transaction_code",value:q,onChange:e=>Z(e.target.value),placeholder:"masukkan kode transaksi"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{children:"Tanggal"}),(0,l.jsx)(c(),{id:"tgl_transaksi",selected:T,onChange:e=>E(e),dateFormat:"yyyy/MM/dd",placeholderText:"Select a date",className:"border border-gray-300 p-2"})]})]}),(0,l.jsxs)("td",{rowSpan:2,colSpan:2,className:"border border-gray-300 p-2",children:[(0,l.jsxs)("div",{className:"chooseBarang",children:[(0,l.jsx)("h6",{children:"Pilih Barang dulu disini"}),h?(0,l.jsx)("p",{children:"Loading..."}):j?(0,l.jsxs)("p",{children:["Error loading options: ",j]}):(0,l.jsxs)("div",{children:[(0,l.jsx)(n.ZP,{value:a,onChange:e=>{t(e),S(e&&"number"==typeof e.harga?e.harga:0),v(1)},options:i,placeholder:"Select a product...",className:"basic-single",classNamePrefix:"select"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{children:"Qty"}),(0,l.jsx)("input",{id:"qty",type:"number",value:m,onChange:e=>v(Number(e.target.value)),min:"1"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{children:"Price"}),(0,l.jsx)("input",{id:"price",type:"number",value:_,readOnly:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{children:"Diskon"}),(0,l.jsx)("input",{id:"discount",type:"number",value:y,onChange:e=>k(Number(e.target.value))})]}),(0,l.jsx)("button",{onClick:null!==C?()=>{if(null!==C&&a&&_>0){let e=y/100*_,t=_-e,l=t*m,s={...a,qty:m,price:_,discount_percent:y,discount_price:e,price_result:t,total:l,id_barang:a.id_barang},n=[...b];n[C]=s,g(n),M()}else alert("Please ensure all fields are filled out correctly.")}:()=>{if(a&&_>0){let e=y/100*_,t=_-e;g([...b,{...a,qty:m,price:_,discount_percent:y,discount_price:e,price_result:t,total:t*m}]),M()}else alert("Please select an item and enter a valid price.")},children:null!==C?"Save":"Add"})]})]}),(0,l.jsx)("a",{href:"/dashboard/barang/tambah",children:"tambah barang baru"})]})]}),(0,l.jsx)("tr",{children:(0,l.jsxs)("td",{colSpan:2,className:"border border-gray-300 p-2",children:[(0,l.jsx)("div",{children:(0,l.jsx)("h6",{children:"Customer"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{children:"Kode"}),(0,l.jsx)("input",{id:"customer_code",value:B,onChange:e=>A(e.target.value),placeholder:"masukkan kode transaksi"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{children:"Nama"}),(0,l.jsx)("input",{id:"customer_name",value:H,onChange:e=>R(e.target.value),placeholder:"masukkan nama customer"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{children:"Telp"}),(0,l.jsx)("input",{id:"customer_telp",value:K,onChange:e=>L(e.target.value),placeholder:"masukkan telp"})]})]})})]})}),(0,l.jsx)("div",{children:f}),(0,l.jsxs)("div",{style:{maxHeight:"400px",overflowY:"auto"},children:[" ",(0,l.jsxs)("table",{className:"min-w-full border border-gray-300",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Tambah"}),(0,l.jsx)("th",{children:"No"}),(0,l.jsx)("th",{children:"Kode barang"}),(0,l.jsx)("th",{children:"Nama barang"}),(0,l.jsx)("th",{children:"Qty barang"}),(0,l.jsx)("th",{children:"Harga barang"}),(0,l.jsx)("th",{children:"% Diskon"}),(0,l.jsx)("th",{children:"(Rp) Diskon"}),(0,l.jsx)("th",{children:"Harga Diskon"}),(0,l.jsx)("th",{children:"Total"})]})}),(0,l.jsx)("tbody",{children:b.map((e,a)=>(0,l.jsxs)("tr",{children:[(0,l.jsxs)("td",{children:[(0,l.jsx)("button",{onClick:()=>Q(a),children:"Remove"}),"\xa0\xa0\xa0 || \xa0\xa0\xa0",(0,l.jsx)("button",{onClick:()=>G(a),children:"Edit"})]}),(0,l.jsx)("td",{children:a+1}),(0,l.jsxs)("td",{children:[(0,l.jsx)("p",{hidden:!0,children:e.id_barang}),e.value]}),(0,l.jsx)("td",{children:e.label}),(0,l.jsx)("td",{children:e.qty}),(0,l.jsx)("td",{children:e.price}),(0,l.jsx)("td",{children:e.discount_percent}),(0,l.jsx)("td",{children:e.discount_price.toFixed(2)}),(0,l.jsx)("td",{children:e.price_result.toFixed(2)}),(0,l.jsx)("td",{children:e.total.toFixed(2)})]},a))}),(0,l.jsxs)("tfoot",{children:[(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{colSpan:8}),(0,l.jsx)("td",{colSpan:1,className:"gtotal",children:"Grand Total"}),(0,l.jsx)("td",{colSpan:1,children:I.toFixed(2)})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{colSpan:8}),(0,l.jsx)("td",{colSpan:1,className:"dgtotal",children:"Discount grand"}),(0,l.jsx)("td",{colSpan:1,children:(0,l.jsx)("input",{className:"input_dgtotal",type:"number",width:40,value:F,onChange:e=>O(Number(e.target.value)),placeholder:"Enter discount %"})})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{colSpan:8}),(0,l.jsx)("td",{colSpan:1,className:"dgtotal",children:"Ongkir"}),(0,l.jsx)("td",{colSpan:1,children:(0,l.jsx)("input",{className:"input_dgtotal",type:"number",width:50,value:P,onChange:e=>D(Number(e.target.value)),placeholder:"Ongkir"})})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{colSpan:8}),(0,l.jsx)("td",{colSpan:1,className:"dgtotal",children:"Total Bayar"}),(0,l.jsx)("td",{colSpan:1,children:J.toFixed(2)})]})]})]}),(0,l.jsx)("div",{children:(0,l.jsxs)("form",{onSubmit:Y,children:[" ",(0,l.jsx)("input",{id:"_transaksi_code",hidden:!0,value:q}),(0,l.jsx)("input",{id:"_tgl_transaksi",hidden:!0,value:T?T.toISOString():""}),(0,l.jsx)("input",{id:"_customer_code",hidden:!0,value:B}),(0,l.jsx)("input",{id:"_customer_name",hidden:!0,value:H}),(0,l.jsx)("input",{id:"_customer_telp",hidden:!0,value:K}),(0,l.jsx)("input",{id:"_subtotal",hidden:!0,value:I}),(0,l.jsx)("input",{id:"_diskon",hidden:!0,value:F}),(0,l.jsx)("input",{id:"_ongkir",hidden:!0,value:P}),(0,l.jsx)("input",{id:"_total_bayar",hidden:!0,value:J}),(0,l.jsx)("button",{type:"submit",children:"save"})," ",(0,l.jsx)("a",{href:"/dashboard",children:"BATAL"})," "]})})]})]})}}},function(e){e.O(0,[223,544,472,585,971,23,744],function(){return e(e.s=681)}),_N_E=e.O()}]);